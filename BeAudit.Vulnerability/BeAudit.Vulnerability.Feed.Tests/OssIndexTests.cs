using System;
using System.Collections.Generic;
using System.Linq;
using BeAudit.Package.Interfaces;
using BeAudit.Vulnerability.Feed.Factories;
using BeAudit.Vulnerability.Interfaces;
using Xunit;
using Moq;

namespace BeAudit.Vulnerability.Feed.Tests
{
    public class OssIndexTests
    {
        [Fact]
        public void GetVulnerability()
        {
            Mock<IPackageIdentifier> mockPackage = new Mock<IPackageIdentifier>();

            mockPackage.Setup(o => o.Coordinates)
                .Returns("maven:com.fasterxml.jackson.core/jackson-databind@2.7.9");

            IPackageIdentifier id = mockPackage.Object;

            IList<IVulnerability> vulnerabilities = VulnerabilityFeed.Instance.GetVulnerabilities(id).ToList();
            
            Assert.NotEmpty(vulnerabilities);
        }
    }
}